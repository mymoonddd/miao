<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <title>‰ΩìÈáçËÆ∞ÂΩï</title>
  <style>
    table {
      width: 700px;
      margin: auto;
      text-align: center;
      border-collapse: collapse;
    }

    th {
      height: 50px;
      background-color: lightblue;
      color: white;
      font-weight: bolder;
      border: solid 1px white;
      padding: 2px 10px;
    }

    td {
      border: solid 1px lightgray;
      padding: 2px 10px;
    }

    input {
      border: none;
      outline: none;
      margin: none;
      padding : none;
      width: 20%;
      height: 10%;
    }
    button {
      outline: none;
      border: none;
      background-color: transparent;
      padding: none;
    }
  </style>
</head>
<body>
  <table>
    <thead>
      <th>Êó•Êúü</th>
      <th>ÁõÆÊ†á</th>
      <th>ËÆ∞ÂΩï(ÂÖ¨Êñ§)</th>
      <th>ËÆ∞ÂΩï(Êñ§)</th>
      <th>Â∑ÆÂÄº</th>
      <th>Ê∏ÖÈô§</th>
    </thead>
    <tbody id="recordsList">
    </tbody>
  </table>
</body>
<script>
  const initRecords = [
    {
      "DATE": "2022-05-21",
      "Weight": 141.60000610351563
    },
    {
      "DATE": "2022-06-05",
      "Weight": 134.1999969482422
    },
    {
      "DATE": "2022-06-07",
      "Weight": 131.39999389648438
    },
    {
      "DATE": "2022-06-13",
      "Weight": 130.60000610351563
    },
    {
      "DATE": "2022-06-18",
      "Weight": 129.8000030517578
    },
    {
      "DATE": "2022-06-21",
      "Weight": 129.60000610351563
    },
    {
      "DATE": "2022-06-26",
      "Weight": 128.60000610351563
    },
    {
      "DATE": "2022-06-28",
      "Weight": 127.80000305175781
    },
    {
      "DATE": "2022-07-03",
      "Weight": 126.5999984741211
    },
    {
      "DATE": "2022-07-10",
      "Weight": 124.4000015258789
    },
    {
      "DATE": "2022-07-12",
      "Weight": 122.19999694824219
    },
    {
      "DATE": "2022-07-17",
      "Weight": 121.80000305175781
    },
    {
      "DATE": "2022-07-24",
      "Weight": 119.4000015258789
    },
    {
      "DATE": "2022-07-26",
      "Weight": 118.80000305175781
    },
    {
      "DATE": "2022-08-02",
      "Weight": 115.80000305175781
    },
    {
      "DATE": "2022-08-05",
      "Weight": 116.0
    },
    {
      "DATE": "2022-08-12",
      "Weight": 114.5999984741211
    },
    {
      "DATE": "2022-08-14",
      "Weight": 112.5999984741211
    },
    {
      "DATE": "2022-08-19",
      "Weight": 111.0
    },
    {
      "DATE": "2022-08-20",
      "Weight": 110.19999694824219
    },
    {
      "DATE": "2022-08-21",
      "Weight": 110.5999984741211
    },
    {
      "DATE": "2022-08-23",
      "Weight": 110.4000015258789
    },
    {
      "DATE": "2022-08-26",
      "Weight": 108.19999694824219
    },
    {
      "DATE": "2022-08-27",
      "Weight": 108.0
    },
    {
      "DATE": "2022-08-28",
      "Weight": 107.5999984741211
    },
    {
      "DATE": "2022-08-29",
      "Weight": 107.4000015258789
    },
    {
      "DATE": "2022-08-30",
      "Weight": 107.19999694824219
    },
    {
      "DATE": "2022-09-02",
      "Weight": 106.19999694824219
    },
    {
      "DATE": "2022-09-03",
      "Weight": 107.5999984741211
    },
    {
      "DATE": "2022-09-04",
      "Weight": 106.19999694824219
    },
    {
      "DATE": "2022-09-05",
      "Weight": 107.0
    },
    {
      "DATE": "2022-09-06",
      "Weight": 106.0
    },
    {
      "DATE": "2022-09-07",
      "Weight": 104.80000305175781
    },
    {
      "DATE": "2022-09-08",
      "Weight": 104.80000305175781
    },
    {
      "DATE": "2022-09-09",
      "Weight": 104.80000305175781
    },
    {
      "DATE": "2022-09-10",
      "Weight": 104.19999694824219
    },
    {
      "DATE": "2022-09-11",
      "Weight": 105.19999694824219
    },
    {
      "DATE": "2022-09-12",
      "Weight": 106.19999694824219
    },
    {
      "DATE": "2022-09-13",
      "Weight": 105.19999694824219
    },
    {
      "DATE": "2022-09-14",
      "Weight": 103.80000305175781
    },
    {
      "DATE": "2022-09-15",
      "Weight": 103.80000305175781
    },
    {
      "DATE": "2022-09-16",
      "Weight": 102.5999984741211
    },
    {
      "DATE": "2022-09-17",
      "Weight": 102.5999984741211
    },
    {
      "DATE": "2022-09-18",
      "Weight": 101.5999984741211
    }
  ]

  const records = JSON.parse(localStorage.WeightRecord) || initRecords

  render()
  function render() {
    recordsList.innerHTML = ''
    for (let i in records) {
      let record = records[i]
      recordsList.innerHTML += `
        <tr data-id=${i}>
          <td>${record.DATE}</td>
          <td>${record.Weight.toFixed(1)}</td>
          <td>${record.record ?? `<input type="text" onchange=takeRecord()>` }</td>
          <td>${record.record ? record.record * 2 : ''}</td>
          <td>${record.record ? (record.record * 2 - Number($(`[data-id="${i-1}"] td:nth-child(4)`).text() || record.record * 2)).toFixed(1) : ''}</td>
          <td><button onclick=clearRecord()>üÜë</button></td>
        </tr>
      `
    }
  }
  function takeRecord() {
    let tar = event.target
    let i = $(tar).parents('tr').attr('data-id')
    records[i].record = tar.value
    tar.parentNode.nextElementSibling.textContent = tar.value * 2
    localStorage.WeightRecord = JSON.stringify(records)
    render()
  }

  function clearRecord() {
    let tar = event.target
    let i = $(tar).parents('tr').attr('data-id')
    delete records[i].record
    localStorage.WeightRecord = JSON.stringify(records)
    render()
  }



</script>
</html>
